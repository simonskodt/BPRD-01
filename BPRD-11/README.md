# Assignment 11

This weeks main goal is to understand how the bytecode generated by micro-C compilers can be improved, and to see how the backwards (continuation-based) micro-C compiler can be modified to achieve further improvements in the bytecode.

## Exercise 12.1

```fsharp
let rec addIFZERO lab3 C =
  match C with
  | GOTO lab2 :: Label lab1 :: C1 when lab3 = lab1 -> IFNZRO lab2 :: Label lab3 :: C1
  | _ -> IFZERO lab3 :: C 
```

From this helper function, which have been called the places where the label `IFZERO` occurs in the `cStmt` and `cExpr` function, we have replaced this with a call to this helper function.

```c
[LDARGS; CALL (1, "L1"); STOP; Label "L1"; 

GETBP; LDI;

IFNZRO "L2"; Label "L3"; CSTI 1111; PRINTI; INCSP -1; Label "L2"; CSTI 2222; PRINTI; RET 1]
```

## Exercise 12.2

Extra match case in the `addCST`.

```fsharp
    | (a, CSTI b :: LT :: C1) -> if a < b 
                                    then CSTI 1 :: C1 
                                    else CSTI 0 :: C1
```

Our simple function to test this functionality.

```c
void main()
{
    if (12 < 22) {
        print 1;
    }
}
```

Generated symbolic bytecode instructions.

```c
Label "L1"; CSTI 1; IFZERO "L2"; 
CSTI 1; PRINTI; RET 0; 
Label "L2"; RET -1]
```

Run in terminal with expected output.

```cmd
> java Machine ex12_2.out   
1 
```

## Exercise 12.3

## Exercise 12.4
